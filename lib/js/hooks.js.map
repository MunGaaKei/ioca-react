{"version":3,"file":"hooks.js","sources":["../../packages/js/hooks.ts"],"sourcesContent":["import { useEffect } from \"react\";\n\ntype TMouseEvent = (e: MouseEvent) => void;\ntype TKeyboardEvent = (e: KeyboardEvent) => void;\ntype TEventOption = {\n\tdisabled?: boolean;\n};\n\nconst ClickEvents = new Set<TMouseEvent>();\nconst MouseMoveEvents = new Set<TMouseEvent>();\nconst MouseUpEvents = new Set<TMouseEvent>();\nconst KeydownEvents = new Set<TKeyboardEvent>();\n\nconst touchable = \"ontouchend\" in document;\nconst EVENTS: any = {\n\tMOVE: touchable ? \"touchmove\" : \"mousemove\",\n\tUP: touchable ? \"touchend\" : \"mouseup\",\n\tKEYDOWN: \"keydown\",\n};\n\ndocument.addEventListener(\n\tEVENTS.MOVE,\n\t(e: MouseEvent) => {\n\t\tfor (const listener of MouseMoveEvents.values()) {\n\t\t\tlistener(e);\n\t\t}\n\t},\n\t{ passive: false }\n);\n\ndocument.addEventListener(EVENTS.UP, (e) => {\n\tfor (const listener of MouseUpEvents.values()) {\n\t\tlistener(e);\n\t}\n});\n\ndocument.addEventListener(EVENTS.KEYDOWN, (e) => {\n\tfor (const listener of KeydownEvents.values()) {\n\t\tlistener(e);\n\t}\n});\n\nexport function useMouseMove(listener: TMouseEvent, options?: TEventOption) {\n\tuseEffect(() => {\n\t\tif (options?.disabled) return;\n\n\t\tMouseMoveEvents.add(listener);\n\t\treturn () => {\n\t\t\tMouseMoveEvents.delete(listener);\n\t\t};\n\t}, [listener]);\n}\n\nexport function useMouseUp(listener: TMouseEvent, options?: TEventOption) {\n\tuseEffect(() => {\n\t\tif (options?.disabled) return;\n\n\t\tMouseUpEvents.add(listener);\n\t\treturn () => {\n\t\t\tMouseUpEvents.delete(listener);\n\t\t};\n\t}, [listener]);\n}\n\nexport function useKeydown(listener: TKeyboardEvent, options?: TEventOption) {\n\tuseEffect(() => {\n\t\tif (options?.disabled) return;\n\n\t\tKeydownEvents.add(listener);\n\t\treturn () => {\n\t\t\tKeydownEvents.delete(listener);\n\t\t};\n\t}, [listener]);\n}\n\nexport function useIntersectionObserver(configs?: IntersectionObserverInit) {\n\tconst WM = new WeakMap();\n\tconst IO = new IntersectionObserver((entries) => {\n\t\tentries.map((entry) => {\n\t\t\tconst callback = WM.get(entry.target);\n\n\t\t\tcallback?.(entry.target, entry.isIntersecting);\n\t\t});\n\t}, configs);\n\n\tfunction observe(target: HTMLElement, callback: Function) {\n\t\tif (WM.get(target)) return;\n\n\t\tWM.set(target, callback);\n\t\ttarget && IO.observe(target);\n\t}\n\n\tfunction unobserve(target: HTMLElement) {\n\t\ttarget && IO.unobserve(target);\n\t\tWM.delete(target);\n\t}\n\n\tfunction disconnect() {\n\t\tIO.disconnect();\n\t}\n\n\treturn {\n\t\tobserve,\n\t\tunobserve,\n\t\tdisconnect,\n\t};\n}\n\nexport function useResizeObserver() {\n\tconst WM = new WeakMap();\n\tconst IO = new ResizeObserver((entries) => {\n\t\tentries.map((entry) => {\n\t\t\tconst callback = WM.get(entry.target);\n\n\t\t\tcallback?.(entry.target);\n\t\t});\n\t});\n\n\tfunction observe(target: HTMLElement, callback: Function) {\n\t\tif (WM.get(target)) return;\n\n\t\ttarget && IO.observe(target);\n\t\tWM.set(target, callback);\n\t}\n\n\tfunction unobserve(target: HTMLElement) {\n\t\ttarget && IO.unobserve(target);\n\t\tWM.delete(target);\n\t}\n\n\tfunction disconnect() {\n\t\tIO.disconnect();\n\t}\n\n\treturn {\n\t\tobserve,\n\t\tunobserve,\n\t\tdisconnect,\n\t};\n}\n"],"names":["MouseMoveEvents","Set","MouseUpEvents","KeydownEvents","touchable","document","EVENTS","MOVE","UP","KEYDOWN","useMouseMove","listener","options","useEffect","add","delete","useMouseUp","useKeydown","disabled","useIntersectionObserver","configs","WM","WeakMap","IO","IntersectionObserver","entries","map","entry","callback","get","target","isIntersecting","observe","set","unobserve","disconnect","useResizeObserver","ResizeObserver","addEventListener","e","values","passive"],"mappings":"kCASA,MAAMA,EAAkB,IAAIC,IACtBC,EAAgB,IAAID,IACpBE,EAAgB,IAAIF,IAEpBG,EAAY,eAAgBC,SAC5BC,EAAc,CACnBC,KAAMH,EAAY,YAAc,YAChCI,GAAIJ,EAAY,WAAa,UAC7BK,QAAS,WAyBM,SAAAC,EAAaC,EAAuBC,GACnDC,GAAU,KAGTb,EAAgBc,IAAIH,GACb,KACNX,EAAgBe,OAAOJ,EAAS,IAE/B,CAACA,GACL,CAEgB,SAAAK,EAAWL,EAAuBC,GACjDC,GAAU,KAGTX,EAAcY,IAAIH,GACX,KACNT,EAAca,OAAOJ,EAAS,IAE7B,CAACA,GACL,CAEgB,SAAAM,EAAWN,EAA0BC,GACpDC,GAAU,KACT,IAAID,GAASM,SAGb,OADAf,EAAcW,IAAIH,GACX,KACNR,EAAcY,OAAOJ,EAAS,CAC9B,GACC,CAACA,GACL,CAEM,SAAUQ,EAAwBC,GACvC,MAAMC,EAAK,IAAIC,QACTC,EAAK,IAAIC,sBAAsBC,IACpCA,EAAQC,KAAKC,IACZ,MAAMC,EAAWP,EAAGQ,IAAIF,EAAMG,QAE9BF,IAAWD,EAAMG,OAAQH,EAAMI,eAAe,GAC7C,GACAX,GAkBH,MAAO,CACNY,QAjBD,SAAiBF,EAAqBF,GACjCP,EAAGQ,IAAIC,KAEXT,EAAGY,IAAIH,EAAQF,GACfE,GAAUP,EAAGS,QAAQF,KAcrBI,UAXD,SAAmBJ,GAClBA,GAAUP,EAAGW,UAAUJ,GACvBT,EAAGN,OAAOe,IAUVK,WAPD,WACCZ,EAAGY,cAQL,UAEgBC,IACf,MAAMf,EAAK,IAAIC,QACTC,EAAK,IAAIc,gBAAgBZ,IAC9BA,EAAQC,KAAKC,IACZ,MAAMC,EAAWP,EAAGQ,IAAIF,EAAMG,QAE9BF,IAAWD,EAAMG,OAAO,GACvB,IAmBH,MAAO,CACNE,QAjBD,SAAiBF,EAAqBF,GACjCP,EAAGQ,IAAIC,KAEXA,GAAUP,EAAGS,QAAQF,GACrBT,EAAGY,IAAIH,EAAQF,KAcfM,UAXD,SAAmBJ,GAClBA,GAAUP,EAAGW,UAAUJ,GACvBT,EAAGN,OAAOe,IAUVK,WAPD,WACCZ,EAAGY,cAQL,CAvHA9B,SAASiC,iBACRhC,EAAOC,MACNgC,IACA,IAAK,MAAM5B,KAAYX,EAAgBwC,SACtC7B,EAAS4B,KAGX,CAAEE,SAAS,IAGZpC,SAASiC,iBAAiBhC,EAAOE,IAAK+B,IACrC,IAAK,MAAM5B,KAAYT,EAAcsC,SACpC7B,EAAS4B,MAIXlC,SAASiC,iBAAiBhC,EAAOG,SAAU8B,IAC1C,IAAK,MAAM5B,KAAYR,EAAcqC,SACpC7B,EAAS4B"}