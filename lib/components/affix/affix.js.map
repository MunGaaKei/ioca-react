{"version":3,"file":"affix.js","sources":["../../../packages/components/affix/affix.tsx"],"sourcesContent":["import classNames from \"classnames\";\nimport { debounce } from \"radash\";\nimport {\n\tChildren,\n\tMouseEvent,\n\tcloneElement,\n\tuseEffect,\n\tuseMemo,\n\tuseState,\n} from \"react\";\nimport \"./index.css\";\nimport ToTop from \"./totop\";\nimport { IAffix } from \"./type\";\n\nconst Affix = (props: IAffix) => {\n\tconst {\n\t\tposition = \"fixed\",\n\t\tleft,\n\t\ttop,\n\t\tright,\n\t\tbottom,\n\t\toffset,\n\t\tstyle,\n\t\tclassName,\n\t\tchildren,\n\t\tgetContainer = () => document.body,\n\t} = props;\n\n\tconst [hidden, setHidden] = useState<boolean>(false);\n\n\tconst hijackChildren = useMemo(() => {\n\t\treturn Children.map(children, (node: any) => {\n\t\t\tif (node.type === ToTop) {\n\t\t\t\tconst { onClick } = node.props;\n\n\t\t\t\treturn cloneElement(node, {\n\t\t\t\t\tkey: node.key,\n\t\t\t\t\t...node.props,\n\t\t\t\t\tonClick: (e: MouseEvent) => {\n\t\t\t\t\t\tconst container = getContainer();\n\n\t\t\t\t\t\tonClick?.(e);\n\t\t\t\t\t\tcontainer?.scrollTo({\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\tbehavior: \"smooth\",\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn node;\n\t\t});\n\t}, [children, getContainer]);\n\n\tuseEffect(() => {\n\t\tconst container = getContainer();\n\t\tif (!offset || !container) return;\n\n\t\tconst listener = debounce({ delay: 160 }, () => {\n\t\t\tconst top = container.scrollTop;\n\n\t\t\tsetHidden(top < offset);\n\t\t});\n\n\t\tlistener();\n\t\tcontainer.addEventListener(\"scroll\", listener);\n\n\t\treturn () => {\n\t\t\tcontainer.removeEventListener(\"scroll\", listener);\n\t\t};\n\t}, [offset, getContainer]);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={classNames(\"i-affix\", className, {\n\t\t\t\t\"i-affix-hidden\": hidden,\n\t\t\t})}\n\t\t\tstyle={{\n\t\t\t\t...style,\n\t\t\t\tposition,\n\t\t\t\tleft,\n\t\t\t\ttop,\n\t\t\t\tright,\n\t\t\t\tbottom,\n\t\t\t}}\n\t\t>\n\t\t\t{hijackChildren}\n\t\t</div>\n\t);\n};\n\nAffix.ToTop = ToTop;\n\nexport default Affix;\n"],"names":["Affix","props","position","left","top","right","bottom","offset","style","className","children","getContainer","document","body","hidden","setHidden","useState","hijackChildren","useMemo","Children","map","node","type","ToTop","onClick","cloneElement","key","e","container","scrollTo","behavior","useEffect","listener","debounce","delay","scrollTop","addEventListener","removeEventListener","_jsx","classNames"],"mappings":"2NAcA,MAAMA,EAASC,IACd,MAAMC,SACLA,EAAW,QAAOC,KAClBA,EAAIC,IACJA,EAAGC,MACHA,EAAKC,OACLA,EAAMC,OACNA,EAAMC,MACNA,EAAKC,UACLA,EAASC,SACTA,EAAQC,aACRA,EAAe,IAAMC,SAASC,MAC3BZ,GAEGa,EAAQC,GAAaC,GAAkB,GAExCC,EAAiBC,GAAQ,IACvBC,EAASC,IAAIV,GAAWW,IAC9B,GAAIA,EAAKC,OAASC,EAAO,CACxB,MAAMC,QAAEA,GAAYH,EAAKpB,MAEzB,OAAOwB,EAAaJ,EAAM,CACzBK,IAAKL,EAAKK,OACPL,EAAKpB,MACRuB,QAAUG,IACT,MAAMC,EAAYjB,IAElBa,IAAUG,GACVC,GAAWC,SAAS,CACnBzB,IAAK,EACLD,KAAM,EACN2B,SAAU,UACT,IAKL,OAAOT,CAAI,KAEV,CAACX,EAAUC,IAoBd,OAlBAoB,GAAU,KACT,MAAMH,EAAYjB,IAClB,IAAKJ,IAAWqB,EAAW,OAE3B,MAAMI,EAAWC,EAAS,CAAEC,MAAO,MAAO,KACzC,MAAM9B,EAAMwB,EAAUO,UAEtBpB,EAAUX,EAAMG,EAAO,IAMxB,OAHAyB,IACAJ,EAAUQ,iBAAiB,SAAUJ,GAE9B,KACNJ,EAAUS,oBAAoB,SAAUL,EAAS,CACjD,GACC,CAACzB,EAAQI,IAGX2B,SACC7B,UAAW8B,EAAW,UAAW9B,EAAW,CAC3C,iBAAkBK,IAEnBN,MAAO,IACHA,EACHN,WACAC,OACAC,MACAC,QACAC,UAGAI,SAAAO,GACI,EAIRjB,EAAMuB,MAAQA"}