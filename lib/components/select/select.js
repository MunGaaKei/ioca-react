import{jsxs as e,jsx as l}from"react/jsx-runtime";import{UnfoldMoreRound as i}from"@ricons/material";import{useReactive as t}from"ahooks";import a from"classnames";import{debounce as n}from"radash";import{useState as r,useMemo as o,useEffect as s}from"react";import{formatOption as p}from"../../js/utils.js";import u from"../popup/popup.js";import c from"../utils/helpericon/helpericon.js";import{Options as m,displayValue as d}from"./options.js";const f=f=>{const{ref:v,type:h="text",name:g,label:b,value:y="",placeholder:V,options:N=[],multiple:x,prepend:j,append:C,labelInline:P,style:S,className:k,message:w,status:D="normal",hideClear:I,hideArrow:O,maxDisplay:z,border:A,filter:F,tip:$,filterPlaceholder:q="...",popupProps:B,onSelect:E,onChange:G,...H}=f,J=t({inputValue:"",filterValue:"",value:y,loading:!1}),[K,L]=r(!1),M=o((()=>p(N)),[N]),Q=o((()=>{const{filterValue:e}=J;if(!e||!F)return M;const l="function"==typeof F?F:l=>l.value.includes(e)||l.label.includes(e);return M.filter(l)}),[M,F,J.filterValue]),R=e=>{J.value=e,G?.(e)},T=(e,l)=>{if(E?.(e,l),x){const l=[...J.value],i=l.findIndex((l=>l===e));return i>-1?l.splice(i,1):l.push(e),void R(l)}L(!1),R(e)},U=n({delay:400},(e=>{const l=e.target.value;J.filterValue=l}));s((()=>{J.value=y}),[y]);const W=x?J.value.length>0:!!J.value,X=!I&&K&&W,Y=w??$;return e("label",{className:a("i-input-label",k,{"i-input-inline":P}),style:S,children:[b&&l("span",{className:"i-input-label-text",children:b}),l(u,{position:"bottom",arrow:!1,fitSize:!0,...B,visible:K,trigger:"none",onVisibleChange:e=>{L(e),F&&(J.filterValue="")},content:l(m,{options:Q,value:J.value,multiple:x,filter:!!F,filterPlaceholder:q,onSelect:T,onFilter:U}),children:e("div",{className:a("i-input-item",{[`i-input-${D}`]:"normal"!==D,"i-input-borderless":!A,"i-input-focus":K}),onClick:()=>L(!0),children:[j,l("input",{ref:v,type:"hidden",value:J.value,...H}),x?W?l("div",{className:a("i-input i-select",{"i-select-multiple":x}),children:d({options:M,value:J.value,multiple:x,maxDisplay:z,onSelect:T})}):l("input",{className:"i-input i-select",placeholder:V,readOnly:!0}):null,!x&&l("input",{value:K?J.filterValue:J.value,className:"i-input i-select",placeholder:J.value||V,onChange:e=>{J.filterValue=e.target.value},readOnly:!F}),l(c,{active:!O,icon:X?void 0:l(i,{}),onClick:e=>{e.stopPropagation(),L(!0),K&&R(x?[]:"")}}),C]})}),Y&&l("span",{className:"i-input-message",children:Y})]})};export{f as default};
//# sourceMappingURL=select.js.map
