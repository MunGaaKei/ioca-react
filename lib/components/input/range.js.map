{"version":3,"file":"range.js","sources":["../../../packages/components/input/range.tsx"],"sourcesContent":["import { MinusRound, PlusRound, SyncAltRound } from \"@ricons/material\";\nimport { useReactive } from \"ahooks\";\nimport classNames from \"classnames\";\nimport { ChangeEvent, MouseEvent, useEffect } from \"react\";\nimport \"../../css/input.css\";\nimport { clamp, formatNumber } from \"../../js/utils\";\nimport Helpericon from \"../utils/helpericon\";\nimport InputContainer from \"./container\";\nimport type { IInputRange } from \"./type\";\n\nconst Range = (props: IInputRange) => {\n\tconst {\n\t\tlabel,\n\t\tname,\n\t\tvalue = props.initValue ?? \"\",\n\t\tinitValue,\n\t\tlabelInline,\n\t\tmin = -Infinity,\n\t\tmax = Infinity,\n\t\ttype,\n\t\tclassName,\n\t\tstatus = \"normal\",\n\t\tmessage,\n\t\ttip,\n\t\tappend,\n\t\tprepend,\n\t\tstep = 1,\n\t\tthousand,\n\t\tprecision,\n\t\thideControl,\n\t\tplaceholder,\n\t\tborder,\n\t\tonChange,\n\t\tonBlur,\n\t\tstyle,\n\t\t...restProps\n\t} = props;\n\n\tconst state = useReactive({\n\t\tvalue,\n\t});\n\n\tconst getRangeNumber = (v: number) => clamp(v, min, max);\n\n\tconst getFormatNumber = (v: number) =>\n\t\tformatNumber(v, { precision, thousand });\n\n\tconst formatInputValue = (v?: string | number) => {\n\t\tif (!v) return \"\";\n\t\tif (typeof v === \"number\" || !thousand) return v;\n\n\t\treturn v.replaceAll(thousand, \"\");\n\t};\n\n\tconst handleChange = (e: ChangeEvent<HTMLInputElement>, i: number) => {\n\t\tconst { value } = e.target;\n\t\tconst v = formatInputValue(value.replace(/[^\\d\\.-]/g, \"\"));\n\n\t\tconst range = Array.isArray(state.value) ? state.value : [];\n\t\trange[i] = +v;\n\n\t\tstate.value = range;\n\t\tonChange?.(range, e);\n\t};\n\n\tconst handleOperate = (\n\t\te: MouseEvent<Element>,\n\t\tparam: number,\n\t\ti: number\n\t) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\n\t\tconst range = Array.isArray(state.value) ? state.value : [];\n\t\tconst value = formatInputValue(range[i]) ?? 0;\n\t\tconst result = getRangeNumber(+value + param);\n\n\t\trange[i] = getFormatNumber(result);\n\n\t\tstate.value = range;\n\t\tonChange?.(range, e);\n\t};\n\n\tconst handleSwitch = (e: MouseEvent) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tconst range = state.value ? state.value : [];\n\t\tconst v = range[0];\n\t\trange[0] = range[1];\n\t\trange[1] = v;\n\n\t\tstate.value = range;\n\t\tonChange?.(range);\n\t};\n\n\tuseEffect(() => {\n\t\tstate.value = value;\n\t}, [value]);\n\n\tconst inputProps = {\n\t\tname,\n\t\tclassName: \"i-input i-input-number\",\n\t\t...restProps,\n\t};\n\n\treturn (\n\t\t<InputContainer\n\t\t\tlabel={label}\n\t\t\tlabelInline={labelInline}\n\t\t\tclassName={className}\n\t\t\tstyle={style}\n\t\t\ttip={message ?? tip}\n\t\t\tstatus={status}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={classNames(\"i-input-item\", {\n\t\t\t\t\t[`i-input-${status}`]: status !== \"normal\",\n\t\t\t\t\t\"i-input-borderless\": !border,\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{prepend && <div className='i-input-prepend'>{prepend}</div>}\n\n\t\t\t\t{!hideControl && (\n\t\t\t\t\t<Helpericon\n\t\t\t\t\t\tactive\n\t\t\t\t\t\ticon={<MinusRound />}\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, -step, 0)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t<input\n\t\t\t\t\tvalue={state.value?.[0] || \"\"}\n\t\t\t\t\tplaceholder={placeholder?.[0]}\n\t\t\t\t\t{...inputProps}\n\t\t\t\t\tonChange={(e) => handleChange(e, 0)}\n\t\t\t\t/>\n\n\t\t\t\t{!hideControl && (\n\t\t\t\t\t<Helpericon\n\t\t\t\t\t\tactive\n\t\t\t\t\t\ticon={<PlusRound />}\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, step, 0)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<Helpericon\n\t\t\t\t\tactive\n\t\t\t\t\ticon={<SyncAltRound />}\n\t\t\t\t\tstyle={{ margin: 0 }}\n\t\t\t\t\tonClick={handleSwitch}\n\t\t\t\t/>\n\t\t\t\t{!hideControl && (\n\t\t\t\t\t<Helpericon\n\t\t\t\t\t\tactive\n\t\t\t\t\t\ticon={<MinusRound />}\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, -step, 1)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t<input\n\t\t\t\t\tvalue={state.value?.[1] || \"\"}\n\t\t\t\t\tplaceholder={placeholder?.[1]}\n\t\t\t\t\t{...inputProps}\n\t\t\t\t\tonChange={(e) => handleChange(e, 1)}\n\t\t\t\t/>\n\n\t\t\t\t{!hideControl && (\n\t\t\t\t\t<Helpericon\n\t\t\t\t\t\tactive\n\t\t\t\t\t\ticon={<PlusRound />}\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, step, 1)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t{append && <div className='i-input-append'>{append}</div>}\n\t\t\t</div>\n\t\t</InputContainer>\n\t);\n};\n\nexport default Range;\n"],"names":["Range","props","label","name","value","initValue","labelInline","min","Infinity","max","type","className","status","message","tip","append","prepend","step","thousand","precision","hideControl","placeholder","border","onChange","onBlur","style","restProps","state","useReactive","formatInputValue","v","replaceAll","handleChange","e","i","target","replace","range","Array","isArray","handleOperate","param","preventDefault","stopPropagation","result","clamp","formatNumber","getFormatNumber","useEffect","inputProps","_jsx","InputContainer","children","_jsxs","classNames","Helpericon","active","icon","MinusRound","onClick","PlusRound","SyncAltRound","margin"],"mappings":"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"}