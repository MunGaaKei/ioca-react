{"version":3,"file":"number.js","sources":["../../../packages/components/input/number.tsx"],"sourcesContent":["import { clamp, formatNumber } from \"@p/js/utils\";\nimport { MinusRound, PlusRound } from \"@ricons/material\";\nimport { useReactive } from \"ahooks\";\nimport classNames from \"classnames\";\nimport { ChangeEvent, useEffect } from \"react\";\nimport \"../../css/input.css\";\nimport Helpericon from \"../utils/helpericon\";\nimport InputContainer from \"./container\";\nimport type { IInputNumber } from \"./type\";\n\nconst Number = (props: IInputNumber) => {\n\tconst {\n\t\tref,\n\t\tlabel,\n\t\tname,\n\t\tvalue = props.initValue ?? \"\",\n\t\tinitValue,\n\t\tlabelInline,\n\t\tstep = 1,\n\t\tmin = -Infinity,\n\t\tmax = Infinity,\n\t\tthousand,\n\t\tprecision,\n\t\ttype,\n\t\tclassName,\n\t\tstatus = \"normal\",\n\t\tappend,\n\t\tborder,\n\t\tprepend,\n\t\tmessage,\n\t\ttip,\n\t\thideControl,\n\t\tstyle,\n\t\tonChange,\n\t\tonEnter,\n\t\tonInput,\n\t\tonBlur,\n\t\t...restProps\n\t} = props;\n\n\tconst state = useReactive({\n\t\tvalue,\n\t});\n\n\tconst getRangeNumber = (v: number) => clamp(v, min, max);\n\n\tconst getFormatNumber = (v: number) =>\n\t\tformatNumber(v, { precision, thousand });\n\n\tconst formatInputValue = (v?: string | number) => {\n\t\tif (!v) return \"\";\n\t\tif (typeof v === \"number\" || !thousand) return v;\n\n\t\treturn v.replaceAll(thousand, \"\");\n\t};\n\n\tconst handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n\t\tconst { value } = e.target;\n\t\tconst v = formatInputValue(value.replace(/[^\\d\\.-]/g, \"\"));\n\n\t\tstate.value = v;\n\t\tonChange?.(+v, e);\n\t};\n\n\tconst handleOperate = (param: number) => {\n\t\tconst value = formatInputValue(state.value) ?? 0;\n\t\tconst result = getRangeNumber(+value + param);\n\n\t\tstate.value = getFormatNumber(result);\n\n\t\tonChange?.(result);\n\t};\n\n\tuseEffect(() => {\n\t\tstate.value = value;\n\t}, [value]);\n\n\tconst inputProps = {\n\t\tref,\n\t\tname,\n\t\tvalue: state.value,\n\t\tclassName: \"i-input i-input-number\",\n\t\tonChange: handleChange,\n\t\t...restProps,\n\t};\n\n\treturn (\n\t\t<InputContainer\n\t\t\tlabel={label}\n\t\t\tlabelInline={labelInline}\n\t\t\tclassName={className}\n\t\t\tstyle={style}\n\t\t\ttip={message ?? tip}\n\t\t\tstatus={status}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={classNames(\"i-input-item\", {\n\t\t\t\t\t[`i-input-${status}`]: status !== \"normal\",\n\t\t\t\t\t\"i-input-borderless\": !border,\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{prepend && <div className='i-input-prepend'>{prepend}</div>}\n\n\t\t\t\t{!hideControl && (\n\t\t\t\t\t<Helpericon\n\t\t\t\t\t\tactive\n\t\t\t\t\t\ticon={<MinusRound />}\n\t\t\t\t\t\tonClick={() => handleOperate(-step)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t<input {...inputProps} />\n\n\t\t\t\t{!hideControl && (\n\t\t\t\t\t<Helpericon\n\t\t\t\t\t\tactive\n\t\t\t\t\t\ticon={<PlusRound />}\n\t\t\t\t\t\tonClick={() => handleOperate(step)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t{append && <div className='i-input-append'>{append}</div>}\n\t\t\t</div>\n\t\t</InputContainer>\n\t);\n};\n\nexport default Number;\n"],"names":["Number","props","ref","label","name","value","initValue","labelInline","step","min","Infinity","max","thousand","precision","type","className","status","append","border","prepend","message","tip","hideControl","style","onChange","onEnter","onInput","onBlur","restProps","state","useReactive","formatInputValue","v","replaceAll","handleOperate","param","result","clamp","formatNumber","getFormatNumber","useEffect","inputProps","e","target","replace","_jsx","InputContainer","children","_jsxs","classNames","Helpericon","active","icon","MinusRound","onClick","PlusRound"],"mappings":"2VAUA,MAAMA,EAAUC,IACf,MAAMC,IACLA,EAAGC,MACHA,EAAKC,KACLA,EAAIC,MACJA,EAAQJ,EAAMK,WAAa,GAAEA,UAC7BA,EAASC,YACTA,EAAWC,KACXA,EAAO,EAACC,IACRA,GAAOC,IAAQC,IACfA,EAAMD,IAAQE,SACdA,EAAQC,UACRA,EAASC,KACTA,EAAIC,UACJA,EAASC,OACTA,EAAS,SAAQC,OACjBA,EAAMC,OACNA,EAAMC,QACNA,EAAOC,QACPA,EAAOC,IACPA,EAAGC,YACHA,EAAWC,MACXA,EAAKC,SACLA,EAAQC,QACRA,EAAOC,QACPA,EAAOC,OACPA,KACGC,GACA3B,EAEE4B,EAAQC,EAAY,CACzBzB,UAQK0B,EAAoBC,GACpBA,EACY,iBAANA,GAAmBpB,EAEvBoB,EAAEC,WAAWrB,EAAU,IAFiBoB,EADhC,GAcVE,EAAiBC,IACtB,MAAM9B,EAAQ0B,EAAiBF,EAAMxB,QAAU,EACzC+B,EAtB+BC,GAsBNhC,EAAQ8B,EAtBO1B,EAAKE,GAwBnDkB,EAAMxB,MAtBiB,CAAC2B,GACxBM,EAAaN,EAAG,CAAEnB,YAAWD,aAqBf2B,CAAgBH,GAE9BZ,IAAWY,EAAO,EAGnBI,GAAU,KACTX,EAAMxB,MAAQA,CAAK,GACjB,CAACA,IAEJ,MAAMoC,EAAa,CAClBvC,MACAE,OACAC,MAAOwB,EAAMxB,MACbU,UAAW,yBACXS,SA1BqBkB,IACrB,MAAMrC,MAAEA,GAAUqC,EAAEC,OACdX,EAAID,EAAiB1B,EAAMuC,QAAQ,YAAa,KAEtDf,EAAMxB,MAAQ2B,EACdR,KAAYQ,EAAGU,EAAE,KAsBdd,GAGJ,OACCiB,EAACC,EACA,CAAA3C,MAAOA,EACPI,YAAaA,EACbQ,UAAWA,EACXQ,MAAOA,EACPF,IAAKD,GAAWC,EAChBL,OAAQA,EAAM+B,SAEdC,SACCjC,UAAWkC,EAAW,eAAgB,CACrC,CAAC,WAAWjC,KAAsB,WAAXA,EACvB,sBAAuBE,cAGvBC,GAAW0B,EAAK,MAAA,CAAA9B,UAAU,kBAAiBgC,SAAE5B,KAE5CG,GACDuB,EAACK,EACA,CAAAC,QACA,EAAAC,KAAMP,EAACQ,MACPC,QAAS,IAAMpB,GAAe1B,KAIhCqC,EAAW,QAAA,IAAAJ,KAETnB,GACDuB,EAACK,EACA,CAAAC,QACA,EAAAC,KAAMP,EAACU,MACPD,QAAS,IAAMpB,EAAc1B,KAI9BS,GAAU4B,EAAA,MAAA,CAAK9B,UAAU,iBAAkBgC,SAAA9B,QAE7B"}