import{jsx as r,jsxs as o,Fragment as s}from"react/jsx-runtime";import{useIntersectionObserver as t}from"../../js/hooks.js";import e from"../../js/usePreview/index.js";import{TFileType as i}from"../../js/usePreview/type.js";import{HideImageTwotone as a}from"@ricons/material";import{useReactive as c}from"ahooks";import n from"classnames";import{useRef as m,useEffect as l}from"react";import u from"../icon/icon.js";import d from"../loading/loading.js";const f=f=>{const{src:p,round:v,size:g,initSize:h,lazyload:j,fallback:b=r(u,{icon:r(a,{}),size:"2em",className:"color-5"}),fit:k,style:y,className:w,cover:z,coverClass:C,usePreview:N,onLoad:x,onError:E,onClick:P,...A}=f,L=c({status:"loading"}),F=m(null),G=k?"100%":void 0,{observe:I,unobserve:M}=t(),S=e(),$=r=>{P?.(r),N&&p&&S({items:[{src:p,type:i.IMAGE}]})};l((()=>{if(p&&(F.current?.complete||(L.status="loading"),j&&F.current))return I(F.current,((r,o)=>{o&&(r.setAttribute("src",r.dataset.src||""),M(r))})),()=>{F.current&&M(F.current)}}),[p]),A[j?"data-src":"src"]=p;const q="loading"===L.status?h:void 0;return r("div",{style:{width:g??q,height:g??q,...y},className:n("i-image",w,{rounded:v,[`i-image-${L.status}`]:L.status}),children:"error"===L.status?b:o(s,{children:[p&&r("img",{ref:F,style:{objectFit:k,width:G,height:G},...A,onLoad:r=>{x?.(r),L.status=void 0},onError:r=>{E?.(r),L.status="error"},onClick:$}),p&&"loading"===L.status&&r(d,{absolute:!0}),z&&r("div",{className:n("i-image-cover",C),onClick:$,children:z})]})})};export{f as default};
//# sourceMappingURL=image.js.map
