{"version":3,"file":"drawer.js","sources":["../../../packages/components/drawer/drawer.tsx"],"sourcesContent":["import { useKeydown } from \"@/packages/js/hooks\";\nimport { useReactive } from \"ahooks\";\nimport classNames from \"classnames\";\nimport { useEffect, useRef } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport Helpericon from \"../utils/helpericon\";\nimport \"./index.css\";\nimport { IDrawer } from \"./type\";\n\nfunction Drawer(props: IDrawer) {\n\tconst {\n\t\tvisible,\n\t\tposition = \"left\",\n\t\theader,\n\t\tfooter,\n\t\tbackdropClosable = true,\n\t\thideCloseButton,\n\t\tkeepDOM,\n\t\tclassName,\n\t\tdisabledEsc,\n\t\tchildren,\n\t\tonVisibleChange,\n\t\tonClose,\n\t\t...restProps\n\t} = props;\n\tconst toggable = useRef(true);\n\tconst state = useReactive({\n\t\tshow: visible,\n\t\tactive: visible,\n\t\tinit: false,\n\t});\n\n\tuseEffect(() => {\n\t\tvisible ? handleShow() : handleHide();\n\t}, [visible]);\n\n\tconst handleShow = () => {\n\t\tif (!toggable.current) return;\n\n\t\tstate.show = true;\n\t\tonVisibleChange?.(true);\n\t\ttoggable.current = false;\n\t\tsetTimeout(() => {\n\t\t\tstate.active = true;\n\t\t\ttoggable.current = true;\n\t\t\tstate.init = true;\n\t\t}, 24);\n\t};\n\n\tconst handleHide = () => {\n\t\tif (!toggable.current) return;\n\t\ttoggable.current = false;\n\n\t\tstate.active = false;\n\t\tsetTimeout(() => {\n\t\t\tif (!keepDOM) {\n\t\t\t\tstate.show = false;\n\t\t\t}\n\t\t\tonVisibleChange?.(false);\n\t\t\ttoggable.current = true;\n\t\t\tonClose?.();\n\t\t}, 240);\n\t};\n\n\tconst handleBackdropClick = function () {\n\t\tbackdropClosable && handleHide();\n\t};\n\n\tuseKeydown(\n\t\t(e) => {\n\t\t\tif (e.code !== \"Escape\" || !visible) return;\n\t\t\thandleHide();\n\t\t},\n\t\t{\n\t\t\tdisabled: disabledEsc,\n\t\t}\n\t);\n\n\treturn createPortal(\n\t\tstate.show && (\n\t\t\t<div\n\t\t\t\tclassName={classNames(\"i-backdrop-drawer\", className, {\n\t\t\t\t\t\"i-active\": state.active,\n\t\t\t\t})}\n\t\t\t\tonClick={handleBackdropClick}\n\t\t\t\t{...restProps}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName={classNames(\"i-drawer\", `i-drawer-${position}`)}\n\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t>\n\t\t\t\t\t<header className='i-drawer-header'>\n\t\t\t\t\t\t{header}\n\n\t\t\t\t\t\t<Helpericon\n\t\t\t\t\t\t\tactive={!hideCloseButton}\n\t\t\t\t\t\t\tclassName='i-drawer-close'\n\t\t\t\t\t\t\tonClick={handleHide}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</header>\n\n\t\t\t\t\t<div className='i-drawer-content'>{children}</div>\n\n\t\t\t\t\t<div className='i-drawer-footer'>{footer}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t),\n\t\tdocument.body\n\t);\n}\n\nexport default Drawer;\n"],"names":["Drawer","props","visible","position","header","footer","backdropClosable","hideCloseButton","keepDOM","className","disabledEsc","children","onVisibleChange","onClose","restProps","toggable","useRef","state","useReactive","show","active","init","useEffect","handleShow","handleHide","current","setTimeout","useKeydown","e","code","disabled","createPortal","_jsx","classNames","onClick","_jsxs","stopPropagation","Helpericon","document","body"],"mappings":"wSASA,SAASA,EAAOC,GACf,MAAMC,QACLA,EAAOC,SACPA,EAAW,OAAMC,OACjBA,EAAMC,OACNA,EAAMC,iBACNA,GAAmB,EAAIC,gBACvBA,EAAeC,QACfA,EAAOC,UACPA,EAASC,YACTA,EAAWC,SACXA,EAAQC,gBACRA,EAAeC,QACfA,KACGC,GACAb,EACEc,EAAWC,GAAO,GAClBC,EAAQC,EAAY,CACzBC,KAAMjB,EACNkB,OAAQlB,EACRmB,MAAM,IAGPC,GAAU,KACTpB,EAAUqB,IAAeC,GAAY,GACnC,CAACtB,IAEJ,MAAMqB,EAAa,KACbR,EAASU,UAEdR,EAAME,MAAO,EACbP,KAAkB,GAClBG,EAASU,SAAU,EACnBC,YAAW,KACVT,EAAMG,QAAS,EACfL,EAASU,SAAU,EACnBR,EAAMI,MAAO,CAAI,GACf,IAAG,EAGDG,EAAa,KACbT,EAASU,UACdV,EAASU,SAAU,EAEnBR,EAAMG,QAAS,EACfM,YAAW,KACLlB,IACJS,EAAME,MAAO,GAEdP,KAAkB,GAClBG,EAASU,SAAU,EACnBZ,KAAW,GACT,KAAI,EAiBR,OAVAc,GACEC,IACe,WAAXA,EAAEC,MAAsB3B,GAC5BsB,GAAY,GAEb,CACCM,SAAUpB,IAILqB,EACNd,EAAME,MACLa,EACC,MAAA,CAAAvB,UAAWwB,EAAW,oBAAqBxB,EAAW,CACrD,WAAYQ,EAAMG,SAEnBc,QApByB,WAC3B5B,GAAoBkB,GACpB,KAmBMV,EAEJH,SAAAwB,EAAA,MAAA,CACC1B,UAAWwB,EAAW,WAAY,YAAY9B,KAC9C+B,QAAUN,GAAMA,EAAEQ,4BAElBD,EAAQ,SAAA,CAAA1B,UAAU,kBAAiBE,SAAA,CACjCP,EAED4B,EAACK,EAAU,CACVjB,QAASb,EACTE,UAAU,iBACVyB,QAASV,OAIXQ,EAAA,MAAA,CAAKvB,UAAU,mBAAoBE,SAAAA,IAEnCqB,EAAA,MAAA,CAAKvB,UAAU,kBAAmBE,SAAAN,SAIrCiC,SAASC,KAEX"}