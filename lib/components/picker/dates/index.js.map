{"version":3,"file":"index.js","sources":["../../../../packages/components/picker/dates/index.tsx"],"sourcesContent":["import { CalendarMonthTwotone } from \"@ricons/material\";\nimport { useReactive } from \"ahooks\";\nimport dayjs, { Dayjs } from \"dayjs\";\nimport customParseFormat from \"dayjs/plugin/customParseFormat.js\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport Icon from \"../../icon\";\nimport Input from \"../../input\";\nimport Popup from \"../../popup\";\nimport { IDatePicker } from \"../type\";\nimport \"./index.css\";\nimport Panel from \"./panel\";\n\ndayjs.extend(customParseFormat);\n\nconst FORMATTYPES = [\"YYYY-MM-DD\", \"YYYY-M-D\", \"YYYY/MM/DD\", \"YYYY/M/D\"];\nconst FORMAT = \"YYYY-MM-DD\";\n\nconst Datepicker = (props: IDatePicker) => {\n\tconst {\n\t\tname,\n\t\tvalue,\n\t\tweeks,\n\t\tformat = FORMAT,\n\t\tplaceholder = props.format ?? FORMAT,\n\t\trenderDate,\n\t\trenderMonth,\n\t\trenderYear,\n\t\tpopupProps,\n\t\tdisabledDate,\n\t\tonDateClick,\n\t\tonChange,\n\t\tonBlur,\n\t\t...restProps\n\t} = props;\n\n\tconst state = useReactive({\n\t\tvalue,\n\t});\n\n\tconst [active, setActive] = useState<boolean>(false);\n\n\tconst dayJsValue = useMemo(() => {\n\t\tif (!state.value) return null;\n\n\t\tconst date = dayjs(state.value as string, format, true);\n\n\t\tif (date.isValid()) return date;\n\n\t\treturn null;\n\t}, [state.value]);\n\n\tconst handleDateClick = (date: Dayjs) => {\n\t\thandleChange(date.format(format));\n\t};\n\n\tconst handleChange = (v) => {\n\t\tstate.value = v;\n\t\tonChange?.(v);\n\t};\n\n\tconst handleSetDate = () => {\n\t\tif (!state.value) return;\n\n\t\tconst date = dayjs(state.value as string, FORMATTYPES, true);\n\n\t\tif (date.isValid()) {\n\t\t\thandleChange(date.format(format));\n\t\t\treturn;\n\t\t}\n\n\t\thandleChange(\"\");\n\t};\n\n\tconst handleBlur = (e) => {\n\t\tonBlur?.(e);\n\t\thandleSetDate();\n\t};\n\n\tconst handleVisibleChange = (v) => {\n\t\tpopupProps?.onVisibleChange?.(v);\n\t\tsetActive(v);\n\t};\n\n\tuseEffect(() => {\n\t\tstate.value = value;\n\t}, [value]);\n\n\treturn (\n\t\t<Popup\n\t\t\tvisible={active}\n\t\t\ttrigger='click'\n\t\t\tposition='bottom'\n\t\t\tarrow={false}\n\t\t\talign='start'\n\t\t\tonVisibleChange={handleVisibleChange}\n\t\t\twatchResize\n\t\t\tcontent={\n\t\t\t\t<Panel\n\t\t\t\t\tvalue={dayJsValue}\n\t\t\t\t\tweeks={weeks}\n\t\t\t\t\trenderDate={renderDate}\n\t\t\t\t\trenderMonth={renderMonth}\n\t\t\t\t\trenderYear={renderYear}\n\t\t\t\t\tdisabledDate={disabledDate}\n\t\t\t\t\tonDateClick={handleDateClick}\n\t\t\t\t/>\n\t\t\t}\n\t\t\t{...popupProps}\n\t\t>\n\t\t\t<Input\n\t\t\t\tvalue={state.value}\n\t\t\t\tappend={\n\t\t\t\t\t<Icon\n\t\t\t\t\t\ticon={<CalendarMonthTwotone />}\n\t\t\t\t\t\tclassName='i-datepicker-icon'\n\t\t\t\t\t\tsize='1em'\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\tplaceholder={placeholder}\n\t\t\t\tonChange={handleChange}\n\t\t\t\tonBlur={handleBlur}\n\t\t\t\tonEnter={handleSetDate}\n\t\t\t\t{...restProps}\n\t\t\t/>\n\t\t</Popup>\n\t);\n};\n\nexport default Datepicker;\n"],"names":["dayjs","extend","customParseFormat","FORMATTYPES","FORMAT","Datepicker","props","name","value","weeks","format","placeholder","renderDate","renderMonth","renderYear","popupProps","disabledDate","onDateClick","onChange","onBlur","restProps","state","useReactive","active","setActive","useState","dayJsValue","useMemo","date","isValid","handleChange","v","handleSetDate","useEffect","_jsx","Popup","visible","trigger","position","arrow","align","onVisibleChange","watchResize","content","Panel","children","Input","append","Icon","icon","CalendarMonthTwotone","className","size","e","onEnter"],"mappings":"yaAYAA,EAAMC,OAAOC,GAEb,MAAMC,EAAc,CAAC,aAAc,WAAY,aAAc,YACvDC,EAAS,aAETC,EAAcC,IACnB,MAAMC,KACLA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,OACLA,EAASN,EAAMO,YACfA,EAAcL,EAAMI,QAAUN,EAAMQ,WACpCA,EAAUC,YACVA,EAAWC,WACXA,EAAUC,WACVA,EAAUC,aACVA,EAAYC,YACZA,EAAWC,SACXA,EAAQC,OACRA,KACGC,GACAd,EAEEe,EAAQC,EAAY,CACzBd,WAGMe,EAAQC,GAAaC,GAAkB,GAExCC,EAAaC,GAAQ,KAC1B,IAAKN,EAAMb,MAAO,OAAO,KAEzB,MAAMoB,EAAO5B,EAAMqB,EAAMb,MAAiBE,GAAQ,GAElD,OAAIkB,EAAKC,UAAkBD,EAEpB,IAAI,GACT,CAACP,EAAMb,QAMJsB,EAAgBC,IACrBV,EAAMb,MAAQuB,EACdb,IAAWa,EAAE,EAGRC,EAAgB,KACrB,IAAKX,EAAMb,MAAO,OAElB,MAAMoB,EAAO5B,EAAMqB,EAAMb,MAAiBL,GAAa,GAEnDyB,EAAKC,UACRC,EAAaF,EAAKlB,OAAOA,IAI1BoB,EAAa,GAAG,EAiBjB,OAJAG,GAAU,KACTZ,EAAMb,MAAQA,CAAK,GACjB,CAACA,IAGH0B,EAACC,EACA,CAAAC,QAASb,EACTc,QAAQ,QACRC,SAAS,SACTC,OAAO,EACPC,MAAM,QACNC,gBAhB2BV,IAC5BhB,GAAY0B,kBAAkBV,GAC9BP,EAAUO,EAAE,EAeXW,aAAW,EACXC,QACCT,EAACU,EACA,CAAApC,MAAOkB,EACPjB,MAAOA,EACPG,WAAYA,EACZC,YAAaA,EACbC,WAAYA,EACZE,aAAcA,EACdC,YArDqBW,IACxBE,EAAaF,EAAKlB,OAAOA,GAAQ,OAuD5BK,EAAU8B,SAEdX,EAACY,EACA,CAAAtC,MAAOa,EAAMb,MACbuC,OACCb,EAACc,EACA,CAAAC,KAAMf,EAACgB,EAAoB,CAAA,GAC3BC,UAAU,oBACVC,KAAK,QAGPzC,YAAaA,EACbO,SAAUY,EACVX,OA/CiBkC,IACnBlC,IAASkC,GACTrB,GAAe,EA8CbsB,QAAStB,KACLZ,KAEE"}