{"version":3,"file":"index.js","sources":["../../../../packages/js/useTheme/index.ts"],"sourcesContent":["import { useLocalStorageState } from \"ahooks\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ITheme } from \"./type\";\r\n\r\nconst useTheme = (props?: ITheme) => {\r\n\tconst {\r\n\t\tkey = \"ioca-react-theme\",\r\n\t\tdefaultValue = \"theme-auto\",\r\n\t\tlistenStorageChange,\r\n\t} = props ?? {};\r\n\r\n\tconst [mounted, setMounted] = useState(false);\r\n\r\n\tconst [theme, setTheme] = useLocalStorageState<string>(key, {\r\n\t\tdefaultValue,\r\n\t\tlistenStorageChange,\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tsetMounted(true);\r\n\t}, []);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!mounted || !theme) return;\r\n\r\n\t\tconst cls = document.documentElement.classList;\r\n\t\tconst prev = Array.from(cls).find((n) => n.startsWith(\"theme-\"));\r\n\r\n\t\tif (prev) {\r\n\t\t\tcls.replace(prev, theme);\r\n\t\t} else {\r\n\t\t\tcls.add(theme);\r\n\t\t}\r\n\t}, [theme, mounted]);\r\n\r\n\treturn {\r\n\t\ttheme: mounted ? theme : defaultValue,\r\n\t\tsetTheme: mounted ? setTheme : () => {},\r\n\t};\r\n};\r\n\r\nexport default useTheme;\r\n"],"names":[],"mappings":";;;AAIA,MAAM,QAAQ,GAAG,CAAC,KAAc,KAAI;AACnC,IAAA,MAAM,EACL,GAAG,GAAG,kBAAkB,EACxB,YAAY,GAAG,YAAY,EAC3B,mBAAmB,GACnB,GAAG,KAAK,IAAI,EAAE;IAEf,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC;IAE7C,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,oBAAoB,CAAS,GAAG,EAAE;QAC3D,YAAY;QACZ,mBAAmB;AACnB,KAAA,CAAC;IAEF,SAAS,CAAC,MAAK;QACd,UAAU,CAAC,IAAI,CAAC;KAChB,EAAE,EAAE,CAAC;IAEN,SAAS,CAAC,MAAK;AACd,QAAA,IAAI,CAAC,OAAO,IAAI,CAAC,KAAK;YAAE;AAExB,QAAA,MAAM,GAAG,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS;QAC9C,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;QAEhE,IAAI,IAAI,EAAE;AACT,YAAA,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;;aAClB;AACN,YAAA,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC;;AAEhB,KAAC,EAAE,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAEpB,OAAO;QACN,KAAK,EAAE,OAAO,GAAG,KAAK,GAAG,YAAY;AACrC,QAAA,QAAQ,EAAE,OAAO,GAAG,QAAQ,GAAG,MAAK,GAAG;KACvC;AACF;;;;"}