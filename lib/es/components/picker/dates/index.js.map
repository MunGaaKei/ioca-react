{"version":3,"file":"index.js","sources":["../../../../../packages/components/picker/dates/index.tsx"],"sourcesContent":["import { CalendarMonthTwotone } from \"@ricons/material\";\r\nimport { useReactive } from \"ahooks\";\r\nimport classNames from \"classnames\";\r\nimport dayjs, { Dayjs } from \"dayjs\";\r\nimport customParseFormat from \"dayjs/plugin/customParseFormat.js\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport Icon from \"../../icon\";\r\nimport Input from \"../../input\";\r\nimport Popup from \"../../popup\";\r\nimport { IDatePicker } from \"../type\";\r\nimport \"./index.css\";\r\nimport Panel from \"./panel\";\r\n\r\ndayjs.extend(customParseFormat);\r\n\r\nconst FORMATTYPES = [\"YYYY-MM-DD\", \"YYYY-M-D\", \"YYYY/MM/DD\", \"YYYY/M/D\"];\r\nconst FORMAT = \"YYYY-MM-DD\";\r\n\r\nconst Datepicker = (props: IDatePicker) => {\r\n\tconst {\r\n\t\tname,\r\n\t\tvalue,\r\n\t\tweeks,\r\n\t\tformat = FORMAT,\r\n\t\tplaceholder = props.format ?? FORMAT,\r\n\t\tclassName,\r\n\t\trenderDate,\r\n\t\trenderMonth,\r\n\t\trenderYear,\r\n\t\tpopupProps,\r\n\t\tdisabledDate,\r\n\t\tonDateClick,\r\n\t\tonChange,\r\n\t\tonBlur,\r\n\t\t...restProps\r\n\t} = props;\r\n\r\n\tconst state = useReactive({\r\n\t\tvalue,\r\n\t});\r\n\r\n\tconst [active, setActive] = useState<boolean>(false);\r\n\r\n\tconst dayJsValue = useMemo(() => {\r\n\t\tif (!state.value) return null;\r\n\r\n\t\tconst date = dayjs(state.value as string, format, true);\r\n\r\n\t\tif (date.isValid()) return date;\r\n\r\n\t\treturn null;\r\n\t}, [state.value]);\r\n\r\n\tconst handleDateClick = (date: Dayjs) => {\r\n\t\thandleChange(date.format(format));\r\n\t};\r\n\r\n\tconst handleChange = (v) => {\r\n\t\tstate.value = v;\r\n\t\tonChange?.(v);\r\n\t};\r\n\r\n\tconst handleSetDate = () => {\r\n\t\tif (!state.value) return;\r\n\r\n\t\tconst date = dayjs(state.value as string, FORMATTYPES, true);\r\n\r\n\t\tif (date.isValid()) {\r\n\t\t\thandleChange(date.format(format));\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\thandleChange(\"\");\r\n\t};\r\n\r\n\tconst handleBlur = (e) => {\r\n\t\tonBlur?.(e);\r\n\t\thandleSetDate();\r\n\t};\r\n\r\n\tconst handleVisibleChange = (v) => {\r\n\t\tpopupProps?.onVisibleChange?.(v);\r\n\t\tsetActive(v);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tstate.value = value;\r\n\t}, [value]);\r\n\r\n\treturn (\r\n\t\t<Popup\r\n\t\t\tvisible={active}\r\n\t\t\ttrigger='click'\r\n\t\t\tposition='bottom'\r\n\t\t\tarrow={false}\r\n\t\t\talign='start'\r\n\t\t\tonVisibleChange={handleVisibleChange}\r\n\t\t\twatchResize\r\n\t\t\tcontent={\r\n\t\t\t\t<Panel\r\n\t\t\t\t\tvalue={dayJsValue}\r\n\t\t\t\t\tweeks={weeks}\r\n\t\t\t\t\trenderDate={renderDate}\r\n\t\t\t\t\trenderMonth={renderMonth}\r\n\t\t\t\t\trenderYear={renderYear}\r\n\t\t\t\t\tdisabledDate={disabledDate}\r\n\t\t\t\t\tonDateClick={handleDateClick}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t{...popupProps}\r\n\t\t>\r\n\t\t\t<Input\r\n\t\t\t\tvalue={state.value}\r\n\t\t\t\tappend={\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\ticon={<CalendarMonthTwotone />}\r\n\t\t\t\t\t\tclassName='i-datepicker-icon'\r\n\t\t\t\t\t\tsize='1em'\r\n\t\t\t\t\t/>\r\n\t\t\t\t}\r\n\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\tonChange={handleChange}\r\n\t\t\t\tonBlur={handleBlur}\r\n\t\t\t\tonEnter={handleSetDate}\r\n\t\t\t\tclassName={classNames(\"i-datepicker-label\", className)}\r\n\t\t\t\t{...restProps}\r\n\t\t\t/>\r\n\t\t</Popup>\r\n\t);\r\n};\r\n\r\nexport default Datepicker;\r\n"],"names":["_jsx"],"mappings":"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"}