{"version":3,"file":"number.js","sources":["../../../../packages/components/input/number.tsx"],"sourcesContent":["import { MinusRound, PlusRound } from \"@ricons/material\";\r\nimport { useReactive } from \"ahooks\";\r\nimport classNames from \"classnames\";\r\nimport { ChangeEvent, useEffect } from \"react\";\r\nimport \"../../css/input.css\";\r\nimport { clamp, formatNumber } from \"../../js/utils\";\r\nimport Helpericon from \"../utils/helpericon\";\r\nimport InputContainer from \"./container\";\r\nimport type { IInputNumber } from \"./type\";\r\n\r\nconst Number = (props: IInputNumber) => {\r\n\tconst {\r\n\t\tref,\r\n\t\tlabel,\r\n\t\tname,\r\n\t\tvalue = \"\",\r\n\t\tlabelInline,\r\n\t\tstep = 1,\r\n\t\tmin = -Infinity,\r\n\t\tmax = Infinity,\r\n\t\tthousand,\r\n\t\tprecision,\r\n\t\ttype,\r\n\t\tclassName,\r\n\t\twidth,\r\n\t\tstatus = \"normal\",\r\n\t\tappend,\r\n\t\tborder,\r\n\t\tprepend,\r\n\t\tdisabled,\r\n\t\tmessage,\r\n\t\ttip,\r\n\t\thideControl,\r\n\t\tstyle,\r\n\t\tonChange,\r\n\t\tonEnter,\r\n\t\tonInput,\r\n\t\tonBlur,\r\n\t\t...restProps\r\n\t} = props;\r\n\r\n\tconst state = useReactive({\r\n\t\tvalue,\r\n\t});\r\n\r\n\tconst getRangeNumber = (v: number) => clamp(v, min, max);\r\n\r\n\tconst getFormatNumber = (v: number) =>\r\n\t\tformatNumber(v, { precision, thousand });\r\n\r\n\tconst formatInputValue = (v?: string | number) => {\r\n\t\tif (!v) return \"\";\r\n\t\tif (typeof v === \"number\" || !thousand) return v;\r\n\r\n\t\treturn v.replaceAll(thousand, \"\");\r\n\t};\r\n\r\n\tconst handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst { value } = e.target;\r\n\t\tconst v = formatInputValue(value.replace(/[^\\d\\.-]/g, \"\"));\r\n\r\n\t\tstate.value = v;\r\n\t\tonChange?.(+v, e);\r\n\t};\r\n\r\n\tconst handleOperate = (param: number) => {\r\n\t\tconst value = formatInputValue(state.value) ?? 0;\r\n\t\tconst result = getRangeNumber(+value + param);\r\n\r\n\t\tstate.value = getFormatNumber(result);\r\n\r\n\t\tonChange?.(result);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tstate.value = value;\r\n\t}, [value]);\r\n\r\n\tconst inputProps = {\r\n\t\tref,\r\n\t\tname,\r\n\t\tdisabled,\r\n\t\tvalue: state.value,\r\n\t\tclassName: \"i-input i-input-number\",\r\n\t\tonChange: handleChange,\r\n\t\t...restProps,\r\n\t};\r\n\r\n\treturn (\r\n\t\t<InputContainer\r\n\t\t\tlabel={label}\r\n\t\t\tlabelInline={labelInline}\r\n\t\t\tclassName={className}\r\n\t\t\tstyle={{ width, ...style }}\r\n\t\t\ttip={message ?? tip}\r\n\t\t\tstatus={status}\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclassName={classNames(\"i-input-item\", {\r\n\t\t\t\t\t[`i-input-${status}`]: status !== \"normal\",\r\n\t\t\t\t\t\"i-input-borderless\": !border,\r\n\t\t\t\t})}\r\n\t\t\t>\r\n\t\t\t\t{prepend && <div className='i-input-prepend'>{prepend}</div>}\r\n\r\n\t\t\t\t{!hideControl && !disabled && (\r\n\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\tactive\r\n\t\t\t\t\t\ticon={<MinusRound />}\r\n\t\t\t\t\t\tonClick={() => handleOperate(-step)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<input {...inputProps} />\r\n\r\n\t\t\t\t{!hideControl && !disabled && (\r\n\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\tactive\r\n\t\t\t\t\t\ticon={<PlusRound />}\r\n\t\t\t\t\t\tonClick={() => handleOperate(step)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{append && <div className='i-input-append'>{append}</div>}\r\n\t\t\t</div>\r\n\t\t</InputContainer>\r\n\t);\r\n};\r\n\r\nexport default Number;\r\n"],"names":["_jsx","_jsxs"],"mappings":"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"}