{"version":3,"file":"drawer.js","sources":["../../../../packages/components/drawer/drawer.tsx"],"sourcesContent":["import { useReactive } from \"ahooks\";\r\nimport classNames from \"classnames\";\r\nimport { useEffect, useRef, useTransition } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { useKeydown } from \"../../js/hooks\";\r\nimport Helpericon from \"../utils/helpericon\";\r\nimport \"./index.css\";\r\nimport { IDrawer } from \"./type\";\r\n\r\nfunction Drawer(props: IDrawer) {\r\n\tconst {\r\n\t\tvisible,\r\n\t\tposition = \"left\",\r\n\t\theader,\r\n\t\tfooter,\r\n\t\tbackdropClosable = true,\r\n\t\thideCloseButton,\r\n\t\tkeepDOM,\r\n\t\tclassName,\r\n\t\tdisabledEsc,\r\n\t\tchildren,\r\n\t\tonVisibleChange,\r\n\t\tonClose,\r\n\t\t...restProps\r\n\t} = props;\r\n\r\n\tconst toggable = useRef(true);\r\n\tconst state = useReactive({\r\n\t\tshow: visible,\r\n\t\tactive: visible,\r\n\t});\r\n\tconst [isPending, startTransition] = useTransition();\r\n\r\n\tconst handleHide = () => {\r\n\t\tif (!toggable.current || isPending) return;\r\n\t\ttoggable.current = false;\r\n\r\n\t\tstartTransition(() => {\r\n\t\t\tstate.active = false;\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (!keepDOM) {\r\n\t\t\t\t\tstate.show = false;\r\n\t\t\t\t}\r\n\t\t\t\tonVisibleChange?.(false);\r\n\t\t\t\ttoggable.current = true;\r\n\t\t\t\tonClose?.();\r\n\t\t\t}, 240);\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleShow = () => {\r\n\t\tif (!toggable.current || isPending) return;\r\n\r\n\t\tstate.show = true;\r\n\t\tonVisibleChange?.(true);\r\n\t\ttoggable.current = false;\r\n\r\n\t\tstartTransition(() => {\r\n\t\t\trequestAnimationFrame(() => {\r\n\t\t\t\tstate.active = true;\r\n\t\t\t\ttoggable.current = true;\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tvisible ? handleShow() : handleHide();\r\n\t}, [visible]);\r\n\r\n\tconst handleBackdropClick = () => {\r\n\t\tbackdropClosable && handleHide();\r\n\t};\r\n\r\n\tuseKeydown(\r\n\t\t(e) => {\r\n\t\t\tif (e.code !== \"Escape\" || !visible) return;\r\n\t\t\thandleHide();\r\n\t\t},\r\n\t\t{\r\n\t\t\tdisabled: disabledEsc,\r\n\t\t}\r\n\t);\r\n\r\n\tif (!state.show) return null;\r\n\r\n\treturn createPortal(\r\n\t\t<div\r\n\t\t\tclassName={classNames(\"i-backdrop-drawer\", className, {\r\n\t\t\t\t\"i-active\": state.active,\r\n\t\t\t})}\r\n\t\t\tonClick={handleBackdropClick}\r\n\t\t\t{...restProps}\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclassName={classNames(\"i-drawer\", `i-drawer-${position}`)}\r\n\t\t\t\tonClick={(e) => e.stopPropagation()}\r\n\t\t\t>\r\n\t\t\t\t{header && (\r\n\t\t\t\t\t<header className='i-drawer-header'>\r\n\t\t\t\t\t\t{header}\r\n\r\n\t\t\t\t\t\t{!hideCloseButton && (\r\n\t\t\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\t\t\tclassName='i-drawer-close'\r\n\t\t\t\t\t\t\t\tonClick={handleHide}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</header>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className='i-drawer-content'>{children}</div>\r\n\r\n\t\t\t\t{footer && <div className='i-drawer-footer'>{footer}</div>}\r\n\t\t\t</div>\r\n\t\t</div>,\r\n\t\tdocument.body\r\n\t);\r\n}\r\n\r\nexport default Drawer;\r\n"],"names":["useRef","useReactive","useTransition","useEffect","useKeydown","createPortal","_jsx","classNames","_jsxs","Helpericon"],"mappings":"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"}