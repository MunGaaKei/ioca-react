{"version":3,"file":"toggle.js","sources":["../../../../packages/components/button/toggle.tsx"],"sourcesContent":["import { useReactive } from \"ahooks\";\r\nimport classNames from \"classnames\";\r\nimport { MouseEvent, useEffect } from \"react\";\r\nimport Button from \"./button\";\r\nimport { IButtonToggle } from \"./type\";\r\n\r\nexport default function Toggle(props: IButtonToggle) {\r\n\tconst {\r\n\t\tref,\r\n\t\tactive,\r\n\t\tactiveClass,\r\n\t\tafter,\r\n\t\tdisabled,\r\n\t\tchildren,\r\n\t\tclassName,\r\n\t\ttoggable,\r\n\t\tonClick,\r\n\t\tonToggle,\r\n\t\t...restProps\r\n\t} = props;\r\n\r\n\tconst state = useReactive({\r\n\t\tactive,\r\n\t\tdone: true,\r\n\t});\r\n\r\n\tconst toggle = async () => {\r\n\t\tconst hasAfter = !!after;\r\n\t\tconst nextActive = !state.active;\r\n\r\n\t\tconst canToggle = toggable ? await toggable() : true;\r\n\t\tif (!canToggle) return;\r\n\r\n\t\tObject.assign(state, {\r\n\t\t\tactive: nextActive,\r\n\t\t\tdone: !hasAfter,\r\n\t\t});\r\n\t\tonToggle?.(nextActive);\r\n\r\n\t\tif (!hasAfter) return;\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tstate.done = true;\r\n\t\t}, 16);\r\n\t};\r\n\r\n\tconst handleClick = (e: MouseEvent<HTMLElement>) => {\r\n\t\tonClick?.(e);\r\n\r\n\t\t!disabled && toggle();\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tObject.assign(state, {\r\n\t\t\tactive,\r\n\t\t\tdone: true,\r\n\t\t});\r\n\t}, [active]);\r\n\r\n\treturn (\r\n\t\t<Button\r\n\t\t\tref={ref}\r\n\t\t\tclassName={classNames(\r\n\t\t\t\tclassName,\r\n\t\t\t\t{ [activeClass || \"\"]: state.active },\r\n\t\t\t\t\"i-btn-toggle\"\r\n\t\t\t)}\r\n\t\t\t{...restProps}\r\n\t\t\tonClick={handleClick}\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclassName={classNames(\"i-btn-toggle-content\", {\r\n\t\t\t\t\t\"i-btn-toggle-active\": state.done,\r\n\t\t\t\t})}\r\n\t\t\t>\r\n\t\t\t\t{state.active ? after ?? children : children}\r\n\t\t\t</div>\r\n\t\t</Button>\r\n\t);\r\n}\r\n"],"names":["useReactive","useEffect","_jsx","Button","classNames"],"mappings":";;;;;;;;;;;;;;AAMwB,SAAA,MAAM,CAAC,KAAoB,EAAA;IAClD,MAAM,EACL,GAAG,EACH,MAAM,EACN,WAAW,EACX,KAAK,EACL,QAAQ,EACR,QAAQ,EACR,SAAS,EACT,QAAQ,EACR,OAAO,EACP,QAAQ,EACR,GAAG,SAAS,EACZ,GAAG,KAAK;IAET,MAAM,KAAK,GAAGA,kBAAW,CAAC;QACzB,MAAM;AACN,QAAA,IAAI,EAAE,IAAI;AACV,KAAA,CAAC;AAEF,IAAA,MAAM,MAAM,GAAG,YAAW;AACzB,QAAA,MAAM,QAAQ,GAAG,CAAC,CAAC,KAAK;AACxB,QAAA,MAAM,UAAU,GAAG,CAAC,KAAK,CAAC,MAAM;AAEhC,QAAA,MAAM,SAAS,GAAG,QAAQ,GAAG,MAAM,QAAQ,EAAE,GAAG,IAAI;AACpD,QAAA,IAAI,CAAC,SAAS;YAAE;AAEhB,QAAA,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE;AACpB,YAAA,MAAM,EAAE,UAAU;YAClB,IAAI,EAAE,CAAC,QAAQ;AACf,SAAA,CAAC;AACF,QAAA,QAAQ,GAAG,UAAU,CAAC;AAEtB,QAAA,IAAI,CAAC,QAAQ;YAAE;QAEf,UAAU,CAAC,MAAK;AACf,YAAA,KAAK,CAAC,IAAI,GAAG,IAAI;SACjB,EAAE,EAAE,CAAC;AACP,KAAC;AAED,IAAA,MAAM,WAAW,GAAG,CAAC,CAA0B,KAAI;AAClD,QAAA,OAAO,GAAG,CAAC,CAAC;AAEZ,QAAA,CAAC,QAAQ,IAAI,MAAM,EAAE;AACtB,KAAC;IAEDC,eAAS,CAAC,MAAK;AACd,QAAA,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE;YACpB,MAAM;AACN,YAAA,IAAI,EAAE,IAAI;AACV,SAAA,CAAC;AACH,KAAC,EAAE,CAAC,MAAM,CAAC,CAAC;AAEZ,IAAA,QACCC,cAAC,CAAAC,cAAM,IACN,GAAG,EAAE,GAAG,EACR,SAAS,EAAEC,mBAAU,CACpB,SAAS,EACT,EAAE,CAAC,WAAW,IAAI,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE,EACrC,cAAc,CACd,KACG,SAAS,EACb,OAAO,EAAE,WAAW,YAEpBF,cACC,CAAA,KAAA,EAAA,EAAA,SAAS,EAAEE,mBAAU,CAAC,sBAAsB,EAAE;gBAC7C,qBAAqB,EAAE,KAAK,CAAC,IAAI;AACjC,aAAA,CAAC,YAED,KAAK,CAAC,MAAM,GAAG,KAAK,IAAI,QAAQ,GAAG,QAAQ,EACvC,CAAA,EAAA,CACE;AAEX;;;;"}