{"version":3,"file":"range.js","sources":["../../../../packages/components/input/range.tsx"],"sourcesContent":["import { MinusRound, PlusRound, SyncAltRound } from \"@ricons/material\";\r\nimport { useReactive } from \"ahooks\";\r\nimport classNames from \"classnames\";\r\nimport { ChangeEvent, MouseEvent, useEffect } from \"react\";\r\nimport \"../../css/input.css\";\r\nimport { clamp, formatNumber } from \"../../js/utils\";\r\nimport Helpericon from \"../utils/helpericon\";\r\nimport InputContainer from \"./container\";\r\nimport type { IInputRange } from \"./type\";\r\n\r\nconst Range = (props: IInputRange) => {\r\n\tconst {\r\n\t\tlabel,\r\n\t\tname,\r\n\t\tvalue,\r\n\t\tlabelInline,\r\n\t\tmin = -Infinity,\r\n\t\tmax = Infinity,\r\n\t\ttype,\r\n\t\tclassName,\r\n\t\tstatus = \"normal\",\r\n\t\tmessage,\r\n\t\ttip,\r\n\t\tappend,\r\n\t\tprepend,\r\n\t\tstep = 1,\r\n\t\twidth,\r\n\t\tthousand,\r\n\t\tprecision,\r\n\t\thideControl,\r\n\t\tplaceholder,\r\n\t\tborder,\r\n\t\tautoSwitch,\r\n\t\tonChange,\r\n\t\tonBlur,\r\n\t\tstyle,\r\n\t\t...restProps\r\n\t} = props;\r\n\r\n\tconst state = useReactive({\r\n\t\tvalue,\r\n\t});\r\n\r\n\tconst getRangeNumber = (v: number) => clamp(v, min, max);\r\n\r\n\tconst getFormatNumber = (v: number) =>\r\n\t\tformatNumber(v, { precision, thousand });\r\n\r\n\tconst formatInputValue = (v?: string | number) => {\r\n\t\tif (!v) return \"\";\r\n\t\tif (typeof v === \"number\" || !thousand) return v;\r\n\r\n\t\treturn v.replaceAll(thousand, \"\");\r\n\t};\r\n\r\n\tconst handleChange = (e: ChangeEvent<HTMLInputElement>, i: number) => {\r\n\t\tconst { value } = e.target;\r\n\t\tconst v = formatInputValue(value.replace(/[^\\d\\.-]/g, \"\"));\r\n\t\tconst range = Array.isArray(state.value) ? state.value : [];\r\n\r\n\t\trange[i] = v;\r\n\t\tstate.value = range;\r\n\t\tonChange?.(range, e);\r\n\t};\r\n\r\n\tconst handleOperate = (\r\n\t\te: MouseEvent<Element>,\r\n\t\tparam: number,\r\n\t\ti: number\r\n\t) => {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\r\n\t\tconst range = Array.isArray(state.value) ? state.value : [];\r\n\t\tconst value = formatInputValue(range[i]) ?? 0;\r\n\t\tconst result = getRangeNumber(+value + param);\r\n\r\n\t\trange[i] = getFormatNumber(result);\r\n\r\n\t\tstate.value = range;\r\n\t\tonChange?.(range, e);\r\n\t};\r\n\r\n\tconst handleSwitch = (e?: MouseEvent) => {\r\n\t\te?.preventDefault();\r\n\t\te?.stopPropagation();\r\n\t\tconst range = state.value ? state.value : [];\r\n\t\t[range[0], range[1]] = [range[1], range[0]];\r\n\r\n\t\tstate.value = range;\r\n\t\tonChange?.(range);\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tstate.value = value;\r\n\t}, [value]);\r\n\r\n\tconst inputProps = {\r\n\t\tname,\r\n\t\tclassName: \"i-input i-input-number\",\r\n\t\t...restProps,\r\n\t};\r\n\r\n\tconst handleBlur = () => {\r\n\t\tif (!autoSwitch) return;\r\n\t\tconst range = Array.isArray(state.value) ? state.value : [];\r\n\r\n\t\tif (range.length < 2) return;\r\n\r\n\t\tconst [left, right] = range.map(Number);\r\n\t\tif (left > right) {\r\n\t\t\thandleSwitch();\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<InputContainer\r\n\t\t\tlabel={label}\r\n\t\t\tlabelInline={labelInline}\r\n\t\t\tclassName={className}\r\n\t\t\tstyle={{ width, ...style }}\r\n\t\t\ttip={message ?? tip}\r\n\t\t\tstatus={status}\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclassName={classNames(\"i-input-item\", {\r\n\t\t\t\t\t[`i-input-${status}`]: status !== \"normal\",\r\n\t\t\t\t\t\"i-input-borderless\": !border,\r\n\t\t\t\t})}\r\n\t\t\t>\r\n\t\t\t\t{prepend && <div className='i-input-prepend'>{prepend}</div>}\r\n\r\n\t\t\t\t{!hideControl && (\r\n\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\tactive\r\n\t\t\t\t\t\ticon={<MinusRound />}\r\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, -step, 0)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<input\r\n\t\t\t\t\tvalue={state.value?.[0] || \"\"}\r\n\t\t\t\t\tplaceholder={placeholder?.[0]}\r\n\t\t\t\t\t{...inputProps}\r\n\t\t\t\t\tonBlur={handleBlur}\r\n\t\t\t\t\tonChange={(e) => handleChange(e, 0)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{!hideControl && (\r\n\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\tactive\r\n\t\t\t\t\t\ticon={<PlusRound />}\r\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, step, 0)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\t\t\t\t<Helpericon\r\n\t\t\t\t\tactive\r\n\t\t\t\t\ticon={<SyncAltRound />}\r\n\t\t\t\t\tstyle={{ margin: 0 }}\r\n\t\t\t\t\tonClick={handleSwitch}\r\n\t\t\t\t/>\r\n\t\t\t\t{!hideControl && (\r\n\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\tactive\r\n\t\t\t\t\t\ticon={<MinusRound />}\r\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, -step, 1)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<input\r\n\t\t\t\t\tvalue={state.value?.[1] || \"\"}\r\n\t\t\t\t\tplaceholder={placeholder?.[1]}\r\n\t\t\t\t\t{...inputProps}\r\n\t\t\t\t\tonBlur={handleBlur}\r\n\t\t\t\t\tonChange={(e) => handleChange(e, 1)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{!hideControl && (\r\n\t\t\t\t\t<Helpericon\r\n\t\t\t\t\t\tactive\r\n\t\t\t\t\t\ticon={<PlusRound />}\r\n\t\t\t\t\t\tonClick={(e) => handleOperate(e, step, 1)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{append && <div className='i-input-append'>{append}</div>}\r\n\t\t\t</div>\r\n\t\t</InputContainer>\r\n\t);\r\n};\r\n\r\nexport default Range;\r\n"],"names":["useReactive","clamp","formatNumber","useEffect","_jsx","InputContainer","_jsxs","classNames","Helpericon","MinusRound","PlusRound","SyncAltRound"],"mappings":"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"}