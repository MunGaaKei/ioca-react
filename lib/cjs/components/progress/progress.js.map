{"version":3,"file":"progress.js","sources":["../../../../packages/components/progress/progress.tsx"],"sourcesContent":["import { useReactive } from \"ahooks\";\r\nimport classNames from \"classnames\";\r\nimport { useEffect, useRef } from \"react\";\r\nimport \"../../css/input.css\";\r\nimport { useMouseMove, useMouseUp } from \"../../js/hooks\";\r\nimport Circle from \"./circle\";\r\nimport \"./index.css\";\r\nimport Line from \"./line\";\r\nimport { IProgress } from \"./type\";\r\n\r\nconst Progress = (props: IProgress) => {\r\n\tconst {\r\n\t\tvalue = 0,\r\n\t\tlineWidth = 8,\r\n\t\tcircleSize = 40,\r\n\t\tprecision = 0,\r\n\t\tstyle,\r\n\t\tdraggable = true,\r\n\t\ttype = \"line\",\r\n\t\tbarClass,\r\n\t\tvertical,\r\n\t\tlabel,\r\n\t\tlabelInline,\r\n\t\tclassName,\r\n\t\trenderCursor,\r\n\t\tonChange,\r\n\t\tonDraggingChange,\r\n\t} = props;\r\n\r\n\tconst ref = useRef<HTMLDivElement>(null);\r\n\tconst state = useReactive({\r\n\t\tvalue,\r\n\t\tdragging: false,\r\n\t\tsize: 0,\r\n\t\tstart: 0,\r\n\t});\r\n\r\n\tconst pageXY = vertical ? \"pageY\" : \"pageX\";\r\n\tconst rectTL = vertical ? \"top\" : \"left\";\r\n\tconst rectWH = vertical ? \"height\" : \"width\";\r\n\r\n\tconst getFixedValue = () => {\r\n\t\tlet value = +state.value.toFixed(precision);\r\n\t\tvalue = Math.min(100, value);\r\n\t\tvalue = Math.max(0, value);\r\n\r\n\t\treturn value;\r\n\t};\r\n\r\n\tconst handleMouseDown = (e) => {\r\n\t\tif (!ref.current || !draggable) return;\r\n\r\n\t\tif (e.touches) {\r\n\t\t\te = e.touches[0];\r\n\t\t}\r\n\r\n\t\tconst rect = ref.current.getBoundingClientRect();\r\n\t\tconst value = ((e[pageXY] - rect[rectTL]) * 100) / rect[rectWH];\r\n\r\n\t\tObject.assign(state, {\r\n\t\t\tvalue: vertical ? 100 - value : value,\r\n\t\t\tsize: rect[rectWH],\r\n\t\t\tstart: rect[rectTL],\r\n\t\t\tdragging: true,\r\n\t\t});\r\n\t\tonDraggingChange?.(true);\r\n\t};\r\n\r\n\tconst handleMouseMove = (e) => {\r\n\t\tif (!state.dragging || !draggable) return;\r\n\t\te.preventDefault();\r\n\r\n\t\tif (e.touches) {\r\n\t\t\te = e.touches[0];\r\n\t\t}\r\n\r\n\t\tconst { start, size } = state;\r\n\t\tconst offset = e[pageXY] - start;\r\n\r\n\t\tif (offset < 0 || offset > size) return;\r\n\r\n\t\tconst value = ((e[pageXY] - start) * 100) / size;\r\n\t\tstate.value = vertical ? 100 - value : value;\r\n\t};\r\n\r\n\tconst handleMouseUp = () => {\r\n\t\tif (!state.dragging || !draggable) return;\r\n\r\n\t\tonChange?.(getFixedValue());\r\n\t\tstate.dragging = false;\r\n\t\tonDraggingChange?.(false);\r\n\t};\r\n\r\n\tuseMouseMove(handleMouseMove);\r\n\tuseMouseUp(handleMouseUp);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (value > 100) {\r\n\t\t\tstate.value = 100;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (value < 0) {\r\n\t\t\tstate.value = 0;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tstate.value = value;\r\n\t}, [value]);\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={classNames(\"i-input-label\", className, {\r\n\t\t\t\t\"i-input-inline\": labelInline,\r\n\t\t\t})}\r\n\t\t\tstyle={style}\r\n\t\t>\r\n\t\t\t{label && <span className='i-input-label-text'>{label}</span>}\r\n\r\n\t\t\t{type === \"line\" && (\r\n\t\t\t\t<Line\r\n\t\t\t\t\tref={ref}\r\n\t\t\t\t\tvertical={vertical}\r\n\t\t\t\t\tlineWidth={lineWidth}\r\n\t\t\t\t\tbarClass={barClass}\r\n\t\t\t\t\tdragging={state.dragging}\r\n\t\t\t\t\tvalue={state.value}\r\n\t\t\t\t\trenderCursor={renderCursor}\r\n\t\t\t\t\tonMouseDown={handleMouseDown}\r\n\t\t\t\t\tonTouchStart={handleMouseDown}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\r\n\t\t\t{type === \"circle\" && (\r\n\t\t\t\t<Circle\r\n\t\t\t\t\tvalue={state.value}\r\n\t\t\t\t\tcircleSize={circleSize}\r\n\t\t\t\t\tlineWidth={lineWidth}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Progress;\r\n"],"names":["useRef","useReactive","useMouseMove","useMouseUp","useEffect","_jsxs","classNames","_jsx","Line","Circle"],"mappings":"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"}