{"version":3,"file":"affix.js","sources":["../../../../packages/components/affix/affix.tsx"],"sourcesContent":["import classNames from \"classnames\";\r\nimport { debounce } from \"radash\";\r\nimport {\r\n\tChildren,\r\n\tMouseEvent,\r\n\tcloneElement,\r\n\tuseEffect,\r\n\tuseMemo,\r\n\tuseState,\r\n} from \"react\";\r\nimport \"./index.css\";\r\nimport ToTop from \"./totop\";\r\nimport { IAffix } from \"./type\";\r\n\r\nconst Affix = (props: IAffix) => {\r\n\tconst {\r\n\t\tposition = \"fixed\",\r\n\t\tleft,\r\n\t\ttop,\r\n\t\tright,\r\n\t\tbottom,\r\n\t\toffset,\r\n\t\tstyle,\r\n\t\tclassName,\r\n\t\tchildren,\r\n\t\tgetContainer = () => {\r\n\t\t\tif (typeof document === \"undefined\") return null;\r\n\t\t\treturn document.body;\r\n\t\t},\r\n\t} = props;\r\n\r\n\tconst [hidden, setHidden] = useState<boolean>(false);\r\n\r\n\tconst hijackChildren = useMemo(() => {\r\n\t\treturn Children.map(children, (node: any) => {\r\n\t\t\tif (node.type === ToTop) {\r\n\t\t\t\tconst { onClick } = node.props;\r\n\r\n\t\t\t\treturn cloneElement(node, {\r\n\t\t\t\t\tkey: node.key,\r\n\t\t\t\t\t...node.props,\r\n\t\t\t\t\tonClick: (e: MouseEvent) => {\r\n\t\t\t\t\t\tconst container = getContainer();\r\n\r\n\t\t\t\t\t\tonClick?.(e);\r\n\t\t\t\t\t\tcontainer?.scrollTo({\r\n\t\t\t\t\t\t\ttop: 0,\r\n\t\t\t\t\t\t\tleft: 0,\r\n\t\t\t\t\t\t\tbehavior: \"smooth\",\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn node;\r\n\t\t});\r\n\t}, [children, getContainer]);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst container = getContainer();\r\n\t\tif (!offset || !container) return;\r\n\r\n\t\tconst listener = debounce({ delay: 160 }, () => {\r\n\t\t\tconst top = container.scrollTop;\r\n\r\n\t\t\tsetHidden(top < offset);\r\n\t\t});\r\n\r\n\t\tlistener();\r\n\t\tcontainer.addEventListener(\"scroll\", listener);\r\n\r\n\t\treturn () => {\r\n\t\t\tcontainer.removeEventListener(\"scroll\", listener);\r\n\t\t};\r\n\t}, [offset, getContainer]);\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={classNames(\"i-affix\", className, {\r\n\t\t\t\t\"i-affix-hidden\": hidden,\r\n\t\t\t})}\r\n\t\t\tstyle={{\r\n\t\t\t\t...style,\r\n\t\t\t\tposition,\r\n\t\t\t\tleft,\r\n\t\t\t\ttop,\r\n\t\t\t\tright,\r\n\t\t\t\tbottom,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{hijackChildren}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nAffix.ToTop = ToTop;\r\n\r\nexport default Affix;\r\n"],"names":["useState","useMemo","Children","ToTop","cloneElement","useEffect","debounce","_jsx","classNames"],"mappings":";;;;;;;;;;;;;;AAcA,MAAM,KAAK,GAAG,CAAC,KAAa,KAAI;IAC/B,MAAM,EACL,QAAQ,GAAG,OAAO,EAClB,IAAI,EACJ,GAAG,EACH,KAAK,EACL,MAAM,EACN,MAAM,EACN,KAAK,EACL,SAAS,EACT,QAAQ,EACR,YAAY,GAAG,MAAK;QACnB,IAAI,OAAO,QAAQ,KAAK,WAAW;AAAE,YAAA,OAAO,IAAI;QAChD,OAAO,QAAQ,CAAC,IAAI;KACpB,GACD,GAAG,KAAK;IAET,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,GAAGA,cAAQ,CAAU,KAAK,CAAC;AAEpD,IAAA,MAAM,cAAc,GAAGC,aAAO,CAAC,MAAK;QACnC,OAAOC,cAAQ,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,IAAS,KAAI;AAC3C,YAAA,IAAI,IAAI,CAAC,IAAI,KAAKC,aAAK,EAAE;AACxB,gBAAA,MAAM,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,KAAK;gBAE9B,OAAOC,kBAAY,CAAC,IAAI,EAAE;oBACzB,GAAG,EAAE,IAAI,CAAC,GAAG;oBACb,GAAG,IAAI,CAAC,KAAK;AACb,oBAAA,OAAO,EAAE,CAAC,CAAa,KAAI;AAC1B,wBAAA,MAAM,SAAS,GAAG,YAAY,EAAE;AAEhC,wBAAA,OAAO,GAAG,CAAC,CAAC;wBACZ,SAAS,EAAE,QAAQ,CAAC;AACnB,4BAAA,GAAG,EAAE,CAAC;AACN,4BAAA,IAAI,EAAE,CAAC;AACP,4BAAA,QAAQ,EAAE,QAAQ;AAClB,yBAAA,CAAC;qBACF;AACD,iBAAA,CAAC;;AAGH,YAAA,OAAO,IAAI;AACZ,SAAC,CAAC;AACH,KAAC,EAAE,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;IAE5BC,eAAS,CAAC,MAAK;AACd,QAAA,MAAM,SAAS,GAAG,YAAY,EAAE;AAChC,QAAA,IAAI,CAAC,MAAM,IAAI,CAAC,SAAS;YAAE;QAE3B,MAAM,QAAQ,GAAGC,eAAQ,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,EAAE,MAAK;AAC9C,YAAA,MAAM,GAAG,GAAG,SAAS,CAAC,SAAS;AAE/B,YAAA,SAAS,CAAC,GAAG,GAAG,MAAM,CAAC;AACxB,SAAC,CAAC;AAEF,QAAA,QAAQ,EAAE;AACV,QAAA,SAAS,CAAC,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC;AAE9C,QAAA,OAAO,MAAK;AACX,YAAA,SAAS,CAAC,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,CAAC;AAClD,SAAC;AACF,KAAC,EAAE,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;IAE1B,QACCC,wBACC,SAAS,EAAEC,mBAAU,CAAC,SAAS,EAAE,SAAS,EAAE;AAC3C,YAAA,gBAAgB,EAAE,MAAM;SACxB,CAAC,EACF,KAAK,EAAE;AACN,YAAA,GAAG,KAAK;YACR,QAAQ;YACR,IAAI;YACJ,GAAG;YACH,KAAK;YACL,MAAM;SACN,EAEA,QAAA,EAAA,cAAc,EACV,CAAA;AAER;AAEA,KAAK,CAAC,KAAK,GAAGL,aAAK;;;;"}